{"t232":"!/c/psdb /s 312 !/endcmd\nif (_j) _j.s({\"text\":\"hello\\na b c\"\n})","t9":"this is nine","t2321":"!/c/psdb /s 312 !/endcmd\nif (_j) _j.s({\"text\":\"act bal #25\\n<pre>\\nCuqo 138+1000+2000\\nCuqi 300\\nCu00 57\\n\\nBuck 240\\nBusv 254\\nprem 151\\nNc 1500\\nOc 2000\\n\\nDis 14740 282p6 /19\\nCitic 11959 179p7 /9\\n@Bar3 1684 1200:7 /7\\nBar5 1224.81 500p7 /7\\nAmex 251.08p7 /5\\nEdFin 236p7 /5\\nCal 34.08 p7 /19-21\\nHe 499p6 /13\\n\\n##Pay w/ cred\\nProg 176p6 /26\\nOrth 315:6 /20\\nDrim 2800 191.63p6 /13\\n877-374-2582 hjgr350\\n\\nHta rw\\nWebts rw\\nCd/ux ro\\n</pre>\\nhttpc://?ia=323\\nhttpr://../../2/3/9a.html?ia=312\\nhttp://lipaotwig-jcc9.c9users.io/twigbud.htm\"})","t123":"TODO:\n- prompt save\n- show via CGI\n- track recent slots for differential commit","t124":"ideas:\n- tinyurl w/read-pw\n- expose helpdev.txt\n- commandline to trigger commit\n- mem pressure disk swap\n- manifest\n- twigbud.html - ok88.fec.twig.js\n- spec slot for command line exec","t601":"//5-17-2016 jchoy v0.117 ok88.fec.twig.js - Ajax\nFecOfx= function(){\n  this.inherit= function( inst, base, a, b, c, d, e ){\n    inst.cstr= base;  inst.cstr(a, b, c, d, e);\n  }\n  this.cgi= function(k,def,qy){\n    var at=(qy+\"\").split(new RegExp(\"[\\&\\?]\"+k+\"=\"));\n    return (at.length==1)?def:at[1].split(\"&\")[0];\n  }\n  this.objCallback= function( $obj, $meth, $arg ){\n    return function(a,b,c,d,e){ $obj[$meth]($arg, a,b,c,d,e); }\n  }\n}\n(ok88= {}).fec=new FecOfx();\n//-----\nFecOfxDom= function(){\n\tok88.fec.inherit( this, FexOfx);\n\tthis.addEl= function( tag, par ){\n\t  if (!par) par= document.body;\n\t  return par.appendChild( document.createElement(tag) );\n\t}\n\tthis.monolog= function(url){\n\t  var im=new Image(); im.src= url;\n\t}\n}\nok88.fec.twig= new FecOfxDom();\n//-----\nCounter= function(){\n    this.add= function(key){\n      if (!this.data[key]) this.data[key]=0;\n      this.data[key]++;\n    }\n    this.restart= function(){\n      this.data= {};\n      this.startTime = new Date();\n    }\n    this.count= function(key){\n      return (this.data[key])? this.data[key] : 0;\n    }\n    this.elapsedTimeSecs= function(){\n      return ((new Date()).valueOf()-this.startTime.valueOf())/1000;\n    }\n    this.restart();\n}\nok88.fec.counter= new Counter();\n\n//-----\nAjax= function() {\n\tok88.fec.inherit( this, ok88.fec.constructor );\n\tvar $t=this;\n\tthis.newHttpRequest= function(){\n\t\tif (window.ActiveXObject)\n\t\t\treturn new ActiveXObject( \"Msxml2.XMLHTTP\" )\n\t\telse return new XMLHttpRequest();\n\t}\n\tthis.webPost= function( url, respHndr, errHndr ){\n\t\tthis.webGet( url, respHndr, errHndr, true );\n\t}\n\tthis.webGet= function( url, respHndr, errHndr, isPost ){\n\t\tif ($t.request) return new $t.constuctor().webGet(\n\t\t\turl, respHndr, errHndr, isPost );\n\t\t$t.initReq( url, isPost );\n\t\t$t.handlers= [respHndr,errHndr];\n\t\tif ((!$t.hc) || (!url)) return $t.handleErr({message:\"No HttpRequest or URL\"});\n\t\ttry {\n\t\t  hc.open( $t.request.method, (isPost)? $t.request.urlPost:url, true );\n\t\t  hc.onreadystatechange= $t.objCallback( $t, \"handleHttp\" );\n\t\t  $t.setReqHdrs( $t.request.params.length );\n\t\t  hc.send( (isPost)? $t.request.params : true );\n\t\t} catch (e) { $t.handlerErr(e); }\n\t}\n\t$t.initReq= function(url, isPost){\n\t\tvar pos= url.indexOf('?');\n\t\t$t.request= {url:url, urlPost:url.substr(0,pos)};\n\t\t$t.request.method= (isPost)? \"POST\":\"GET\";\n\t\t$t.request.params= (isPost)? (url.substr(pos+1)) : \"\";\n\t\t$t.hc = $t.newHttpRequest();\n\t}\n\t$t.setReqHdrs= function(len){\n\t\tvar hn=[\"If-Modified-Since\",\"Content-type\",\"Content-length\"];\n\t\t$hc.setRequestHeader( hn[0], \"Sat, 1 Jan 2000 00:00:00 GMT\" );\n\t\tif (!len) return;\n\t\t$hc.setRequestHeader(hn[1], \"application/x-www-form-urlencoded\");\n\t\t$hc.setRequestHeader(hn[2], len);\n\t\t$hc.setRequestHeader(\"Connection\", \"close\");\n\t}\n\t$t.handleHttp= function(){\n\t\tif (this.hc.readyState != 4) return;\n\t\tif ((this.hc.status == 200) || (this.hc.status == 0)) {\n\t\t\tvar res= $t.response= {text:$t.hc.responseText}; \n\t\t\tres.headers= this.hc.getAllResponseHeaders(); \n\t\t\treturn ($t.handlers[0])? $t.handlers[0](res.text, $t) : null;\n\t\t}\n\t\t$t.handlerErr({message:($t.hc.status+\" - \"+ $t.hc.statusText)});\n\t}\n\t$t.handleErr= function(e){ if ($t.handlers[1]) $t.handlers[1](e) }\n}\nok88.fec.twig.ajax = new Ajax();\n\n//loadJson\n//fs\n//sql","t602":"//6-1-2016 ts602 config\ncfg= { color:'blue'\n  ,topLevel:{ sendPkgUrl: \"lipaotwig.io/ts/set/?i={0}\"\n             ,textPkgUrl: \"/ts/text/{0}.txt\"}\n}\ncfg= { color:'blue'\n  ,topLevel:{ sendPkgUrl: \"/ts/set/?i={0}\"\n             ,textPkgUrl: \"/ts/text/?i={0}\"}\n}\n","t125":"corrupted rip-ts slots that need to be restored\n2292\n2334","t604":"//8-11-2016 jchoy v0.291 SnCurly.cfgJsLoader, SnLiteLoader\n//5-18-2016 jchoy v0.117 js604.appTool\n//-----\nSnAppFdn= function(){\n  this.inherit= function( inst, base, a, b, c, d, e ){\n    inst.cstr= base;  inst.cstr(a, b, c, d, e);\n  }\n  this.cgi= function(k,def,qy){\n    var at=(qy+\"\").split(new RegExp(\"[\\&\\?]\"+k+\"=\"));\n    return (at.length==1)?def:at[1].split(\"&\")[0];\n  }\n  this.addEl= function( tag, par ){\n\tif (!par) par= document.body;\n\treturn this._=par.appendChild( document.createElement(tag) );\n  }\n  this.exposeClassNames= function(obj){\n    for (var m in obj){\n      window[this._=m.charAt(0).toUpperCase()+m.substr(1)]= obj[m].constructor;\n      console.log( this._+\" class name is now defined.\");\n    } //TODO: check for native code, window/global\n  }\n}\nSnAppLoader= function(){\n  new SnAppFdn().inherit( this, SnLiteLoader );\n  var $t= this;\n  this.sendPkgUrl= \"/ts/set/?i={0}\";\n  this.textPkgUrl= \"/ts/text/?i={0}\";\n  this.prepChkPkg= function($s){\n    try {$t.pkgBefore= pkg} catch(e) {}\n    this.setNotification( function(){ $t.checkPkg($s) } );\n  }\n  this.setNotification= function($fcn){\n    $t.chainNotify= null;\n    try{ $t.chainNotify= _n } catch(e) {};\n    _n= function(){ _n=$t.chainNotify; $fcn(); setTimeout('if(_n)_n()',100) }\n  }\n  this.checkPkg= function($s){\n    if ($t.pkgBefore == pkg) return $t.setNotification( function(){ $t.checkPkg($s) } );\n    $t.pkgBefore=pkg;\n    $t.gotNewPkg($s);\n  }\n  this.gotNewPkg= function(s){  //override this\n    pkg.starter.start();  //or specific action based on s\n  }\n}\nSnLiteLoader= function(){\n  new SnAppFdn().inherit( this, SnAppFdn );\n  var $t= this;\n  this.sendPkgUrl= this.textPkgUrl= \"{0}\";\n  this.loadJs= function($s){\n    var hd0= document.getElementsByTagName('head')[0];\n    this.prepChkPkg($s);\n    if ($s) this.addEl('script', hd0 ).src= this.textPkgUrl.replace('{0}',$s); \n  }\n  this.cfgJsLoader= function( nm ){\n    var cfg= (window[nm])? window[nm] : {};\n    for (var m in cfg.topLevel) this[m]= cfg.topLevel[m];\n  }\n  this.prepChkPkg= function(){}\n  this.sendPkg= function(json, num){\n    var im=new Image(), res= \"pkg=\"+ JSON.stringify(json) +\"\\ntry{_n()}catch(e){}\";\n    im.src= this.sendPkgUrl.replace('{0}',num) +\"&data=\"+escape(res);\n  }\n}\n\n//-----\nSnCurly= function(){\n  new SnAppFdn().inherit( this, SnLiteLoader);\n  var $t= this;\n  this.start= function( csvTs, csvCN, fcn ){\n    this.startParms= [csvCN.split(','), fcn];\n    this.cfgJsLoader( 'cfg' );\n    for (var i=0,at=csvTs.split(','); i<at.length; i++)  this.loadJs( at[i] );\n    this.count= 55;\n    this.timer= setInterval( function(){ $t.doStart(); $t.count-- }, 100 );\n  }\n  //this.checkPkg= function(){}\n  this.doStart= function(){\n    if (this.count<=0) clearInterval( this.timer );\n    for (var i=0,at=this.startParms[0]; i<at.length; i++) if ( !window[at[i]] ) return;\n    clearInterval( this.timer );\n    this.startParms[1]();\n  }\n}\n\n//-----\nSnApp= function(){\n  new SnAppFdn().inherit( this, SnAppLoader);\n  this.start= function(){\n    //this.addEl('div').innerHTML= 'start 604';\n    console.log( 'start 604' );\n    this.cfgJsLoader( 'cfg' );\n    this.loadJs( this.cgi('js','610',location) );\n  }\n}\n//-----\npkg={\n   snAppFdn: new SnAppFdn()\n  ,appTool:  new SnAppLoader()\n  ,snLiteLoader:  new SnLiteLoader()\n  ,snAppLoader:  new SnAppLoader()\n  ,snCurly: new SnCurly()\n  ,starter:  new SnApp()\n}\n\n//----- client usage\ncfg= { color:'blue'\n  ,topLevel:{ sendPkgUrl: \"/ts/set/?i={0}\"\n             ,textPkgUrl: \"/ts/text/?i={0}\"}\n}\n/*\njs604= pkg;\njs604.appTool.exposeClassNames( js604 );\njs604.starter.start();\n*/\n\n//_n= function(){ fanPkg=pkg; fanPkg.starter.start() }\n//if(_n)_n();\n","t605":"https://dl.dropboxusercontent.com/u/28448395/jsondata/psdb/ape/3d/2/3/9a.html?ia=312","t606":"//5-17-2016 v0.112 #512\nfunction PageApp(){ \n  (function(t,c){t.c=c;t.c()})( this,DivApp);\n  var $t= this;\n\n  this.start= function(div){\n    div.innerHTML=\"resetting...\";\n    new JsonLoader().global();\n    _j.subscribe($t, \"gotNotified\");\n    url=\"http://lipaotwig-jcc9.c9users.io/ts/text/?i=\";\n    $t.addEl( document.getElementsByTagName('head')[0]\n      , 'script').src= url+'604';\n  }\n  $t.gotNotified=function(){ \n    alert(9);\n  } \n}","t608":"//5-19-2016 jchoy v0.118 js608.starter\n//-----\nSnApp= function(){\n  pkg.appTool.inherit( this, AppTool );\n  var $t= this;\n  this.counter= new Counter();\n  this.colors= 'red,blue,green,yellow'.split(',');\n  this.sizes= '5,10,20,30,40,45,50'.split(',');\n  this.start= function(){\n    this.addEl('div').innerHTML= document.title = 'start 608'\n    $t.div= $t.addEl('div');\n    setInterval( function(){ $t.dotClick() }, 1000 );\n  }\n  this.rndColorSize= function(k){\n    $t.counter.add( k );\n    var n= $t.counter.count( k );\n    return [$t.colors[n % $t.colors.length], $t.sizes[n % $t.sizes.length]];\n  }\n  this.dotClick= function(el){\n    var cz= $t.rndColorSize( (el)? el.style.backgroundColor : 'red' );\n    $t.div.appendChild( $t.mkDot(cz[0],cz[1]) ).onclick=function(){\n      $t.dotClick(this);\n    }\n  }\n  this.mkDot= function( bg, sz ){\n    var res= $t.addEl('span');\n    res.innerHTML= '';\n    res.style.backgroundColor= bg;\n    res.style.width= res.style.height= sz;\n    res.style.overflow = 'hidden';\n    res.style.display = 'inline-block';\n    res.style.borderRadius= sz/2;\n    return res;\n  }\n}\njs608=pkg={};\npkg.appTool= new AppTool();\npkg.starter= new SnApp();\npkg.appTool.exposeClassNames( pkg );\n\nif (_n)_n();","t609":"//7-10-2016 jchoy v1.112 findTeammate, pz.w, pkg.classes, emode\n//5-19-2016 jchoy v0.118 js609.starter\n//TODO: viewPort, gravity, proximity, spin, background parallax, bounce collide\n\njs609= pkg={ver:'v1.112'}\n//-----\nMyDemo= function(){\n  new AppTool().inherit( this, AppTool );\n  var $t= this;\n  this.svgEls= [];\n  this.pz={w:600, h:200};\n  this.isEnhanced= (this.cgi( 'emode','',location )) ? true : false;\n  this.colors= (\"green,yellow,pink,orange,lime,aqua\").split(',');\n  this.start= function(){\n    this.loadJs('612');\n  }\n  this.gotNewPkg= function(){\n    if (pkg.svgMotion) this.startAfterLoadJs();\n  }\n  this.startAfterLoadJs= function(){\n    this.addEl('div').innerHTML= document.title = '609 - Click canvas to start';\n    (this.imr=new IconMaker()).size= {width:40, height:40};\n\n    this.smo= new SvgMotion();\n    this.smo.start( $t.pz.w, $t.pz.h, \"#CCEECC\" );\n    setInterval( function(){$t.play()}, 200 );\n\n    this.smo.canvas.addEventListener( \"mousedown\", function(e){$t.cnvClick(e)} );\n    this.seo= new SvgElOverlay();\n    var clr= \"red,red,red,orange,orange,yellow,yellow,lime,lime,lime,lime\".split(',');\n    for (var i=0; i<11; i++)\n      this.seo.addOverlay( 'dot'+i, this.seo.mkDot(clr[i],5+i), 6, 1 );\n  }\n  this.play= function(){\n    for (var i=0,at=this.svgEls; i<at.length; i++)\n      if (at[i].isAtWall('x','w',$t.pz.w))  at[i].hitWall('x', $t.pz.w)\n      else if (at[i].isAtWall('y','h',$t.pz.h)) at[i].hitWall('y', $t.pz.h);\n\n    if (this.isEnhanced) {\n      for (var i=0,at=this.svgEls,zo=new Zoner(); i<at.length; i++)\n        zo.setZone(at[i]);\n      for (var i=0,at=this.svgEls; i<at.length; i++)\n        at[i].collide();\n    }\n  }\n  this.addItem= function( gp ){\n      for (var i=0,at=this.svgEls; i<at.length; i++)  //cleanup\n        if (!at[i].isVisible) at[i]=this.svgEls.pop();\n      this.svgEls.push( gp );\n      gp.seo= this.seo;\n      this.seo.applyOverlay( gp, 'dot10' );\n      return gp;\n  }\n  this.cnvClick= function(evt){\n      var cl=$t.colors.length, ri=new Date().getMilliseconds(), i=$t.svgEls.length;\n      var gp= new GamePiece(\n        this.imr.mkIconImg( \"UVWXYZ\".charAt(ri%cl), $t.colors[ri%cl] ), \n        this.smo.getEventPos(evt).x, this.smo.getEventPos(evt).y );\n      gp.vel= { x: (ri%12)-6, y: ((ri+i)%12)-6 , angle: 0 };\n      gp.team= $t.colors[ri%cl];\n      this.smo.addItem( this.addItem(gp) );\n  }\n}\n//-----\nGamePieceNormal = function(img, x, y){\n  new AppTool().inherit( this, SvgEl );\n  this.init( img, x, y );\n  this.isAtWall= function(xy, wh, pzz){\n    return ((this.pos[xy]<=0) || (this.pos[xy]+this.pos[wh]>=pzz));\n  }\n  this.hitWall= function( xy, pz ){\n    var pj2= this.pos[xy]+this.pos[xy];\n    if ((pj2>pz) && (this.vel[xy]>0)) this.vel[xy]=-this.vel[xy];\n    if ((pj2<pz) && (this.vel[xy]<0)) this.vel[xy]=-this.vel[xy];\n  }\n}\n//-----\nGamePieceEnhanced = function(img, x, y){\n  new AppTool().inherit( this, GamePieceNormal, img, x, y );\n  this.health= 10;\n  this.speedLimit= 20;\n  this.prevPos10=0;\n  this.collide= function(){\n    if (!this.zoner) return;\n    if (!this.isVisible) return;\n    var isHit= false;\n    for (var i=0,at=this.zoner.getNearby(this.zone); i<at.length; i++)\n      if ((at[i] == this) || (!at[i].isVisible)) {\n      } else if (this.distanceFrom(at[i])>this.img.width) {\n      } else {\n        isHit= true;\n        if (at[i].team==this.team) {\n          this.health= 10;\n        } else {\n          this.health--;\n          this.changeDir( this.vel, [this.pos.x-at[i].pos.x,this.pos.y-at[i].pos.y] );\n          if (this.speedLimit) for (var xy in {x:0,y:1})\n            if (this.vel[xy]>this.speedLimit) \n              this.vel[xy]=this.speedLimit;\n        }\n      }\n    this.towardTeammate();\n    if (this.health <= 0) this.isVisible= false;\n    this.seo.applyOverlay( this, 'dot'+this.health );\n  }\n  this.towardTeammate= function(){\n    var tmate, dist=999, p0=this.pos.x, p1=this.pos.y;\n    if (this.prevPos10 != p1+p0) \n      return this.prevPos10 = p1+p0;\n    for (var i=0,at=this.zoner.getFromOtherZones(this.zone); i<at.length; i++)\n      if ((at[i].team==this.team) && (at[i]!=this)) {\n        var di = this.distanceFrom(at[i]);\n        if (di<dist) {tmate= at[i];  dist= di; }\n      }\n    if (!tmate) return;\n    if (this.health<7) {\n      this.changeDir( this.vel, [tmate.pos.x-p0, tmate.pos.y-p1] );  \n      console.log( \"go toward \"+this.team );        \n    } else {\n      this.changeDir( this.vel, [p0-tmate.pos.x, p1-tmate.pos.y] );\n      console.log( \"go away from \"+this.team );\n    }\n  }\n  this.distanceFrom= function(el){\n    return [el.pos.x-this.pos.y, this.pos.x-el.pos.y,\n      el.pos.y-this.pos.y, this.pos.y-el.pos.y].sort().pop();\n  }\n}\n\npkg.classes= {};\npkg.classes.MyDemo = MyDemo;\npkg.classes.GamePieceNormal = GamePieceNormal;\npkg.starter= new MyDemo();\nGamePiece= (pkg.starter.isEnhanced)? GamePieceEnhanced : GamePieceNormal;\n\nif (_n)_n();","t610":"//6-12-2016 jchoy v0.252 cfgJsLoader\n//5-19-2016 jchoy v0.118 js610.starter\n//-----\nSnApp= function(){\n  new AppTool().inherit( this, AppTool );\n  var $t= this;\n  this.tsNum= '603'\n  this.start= function(){\n    this.tsNum= this.cgi('ts','603',location);\n    this.addEl('div').innerHTML= document.title = 'Preview '+this.tsNum;\n    this.form= this.setupForm( $t.addEl('div') );\n    this.div= this.addEl('div');\n    this.cfgJsLoader( 'cfg' );\n    this.loadJs(this.tsNum);\n  }\n  this.setupForm= function(fm){\n    var fm = $t.addEl( 'form', $t.div );\n    $t.addEl( 'textarea', fm ).name= 'ta1';\n    $t._.rows=9;  $t._.cols= 45;\n    $t.addEl( 'br', fm );\n    $t.setupButton( $t.addEl('input', fm), 'Preview' );\n    $t.setupButton( $t.addEl('input', fm), 'Save' );\n    return fm;\n  }\n  this.setupButton= function(el, val){\n    el.type= 'button'; el.value= val;\n    el.onclick= function(){ $t.doButtonClick(this) }\n  }\n  this.doButtonClick= function(el){\n    if (el.value==\"Save\"){\n      this.sendPkg( {text:el.form.ta1.value}, this.tsNum );\n    } else if (el.value==\"Preview\")\n      new AutoLink().show( el.form.ta1.value, this.div );\n  }\n  this.gotNewPkg= function(s){  //override\n    this.form.ta1.value= pkg.text;\n    this.form= null;\n  }\n}\n//-----\nAutoLink= function(){\n  new AppTool().inherit( this, AppTool );\n  this.lastLinkUrl= location+\"{0}\";\n  this.show= function( s, el ){\n    el.innerHTML= '';\n    for (var i=0,at=s.split('\\n'); i<at.length; i++){\n      var s8= at[i].substr(0,8);\n      if (s8.indexOf('http') != 0){\n        this.addEl('div',el).innerHTML= (at[i])? at[i] : \"&nbsp;\";\n      } else if (s8=='httpt://') {\n        this.doLinkTemplate( at[i], this.addEl('div',el) );\n      } else \n        this.doLink( at[i], this.addEl('div',el) );\n    }\n  }\n  this.doLink= function( s, el ){\n    var res= s.replace('#h',location.hostname);\n    this.addEl('a',el).innerHTML= res;\n    this._.href= this.lastLinkUrl= res;\n  }\n  this.doLinkTemplate= function( s, el ){\n    var res= this.lastLinkUrl+'', tx= this.addEl('a',el).innerHTML= s;\n    for (var i=2,j=0,at=s.split(\"/\"); i<at.length; i++,j++)\n      while (res.indexOf(\"{\"+j+\"}\") >= 0)  res= res.replace( \"{\"+j+\"}\", at[i] );\n    this._.href = res;\n  }\n}\njs610=pkg={};\npkg.starter= new SnApp();\npkg.starter.exposeClassNames( pkg );\n\n\nif (_n)_n();","t603":"pkg={\"text\":\"hello anything\\nhttpt://&ts=611\\n\\nhttp://#h/twigbud.htm?js=610&ts={0}\\nhttpt://611\\nhttpt://614\\nhttpt://615\\n\\nhttp://#h/twigbud.htm?js={0}\\nhttpt://608\\nhttpt://609\\nhttpt://610\\nhttpt://613\\nhttpt://612\\nhttpt://617\\nhttpt://619\\nhttpt://619&cts=622,621,623,625\\n\\nhttp://www.nba.com/tntovertime/splash-tablet.html\\nhttp://#h/ts\\nhttp://#h/commit/\\n\\nhttps://ide.c9.io/jcc9/lipaotwig\\nhttps://ide.c9.io/jcc9/relic-ololi\\nhttps://relic-ololi-jcc9.c9users.io/relic/count\\n\\nhttps://dl.dropboxusercontent.com/u/{0}/{1}\\nhttpt://28448395/devbuild.txt\\nhttps://dl.dropboxusercontent.com/u/{0}/jsondata/psdb/ape/3d/{1}/{2}/{3}.html?ia={4}\\nhttpt://28448395/2/3/9a/312\\n\\nhttps://dl.dropboxusercontent.com/u/{0}/proj-h5-01/webproj2016/localImage/{1}\\nhttpt://28448395/localImg.html\\n\\nhttp://b.okdaily.com/f/toy/twig618/twigbud.htm?js={0}\\nhttpt://617\"}\nif(_n)_n()","t611":"pkg={\"text\":\"another file\\nhttp://lipaotwig-jcc9.c9users.io/twigbud.htm?js=610\\nhttps://dl.dropboxusercontent.com/u/{0}/jsondata\\nhttpt://tp9345/abc\\n\\nhttp://lipaotwig-jcc9.c9users.io/twigbud.htm?js={0}&ts={1}\\nhttpt://608\\nhttpt://609\\nhttpt://610/603\\n\\nhttps://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Basic_animations\\n\"}\nif(_n)_n()","t612":"//5-21-2016 jchoy v0.424 getFromOtherZones, pz.w, SvgEl\n//5-21-2016 jchoy v0.391 js612 SvgOverlay\n//TODO: viewPort, gravity, proximity, spin, background parallax\n//-----\nSvgMotion= function(){\n  new AppTool().inherit( this, AppTool );\n  var $t= this;\n  this.frameIntervalMs = 50;\n  this.svgEls= [];\n  this.start= function(width, height, color, canvasEl){\n    if (!(this._=canvasEl)){\n      this.addEl('canvas').width= width;\n      this._.height= height;\n    }\n    this.pz= {w: (this.canvas=this._).width, h: this._.height};\n    this.bgColor = color;\n    this.ctx = this._.getContext('2d');\n    //window.requestAnimationFrame( function(){$t.repaint()} );\n    setInterval( function(){$t.repaint()}, this.frameIntervalMs );\n  }\n  this.repaint= function(){\n    this.ctx.fillStyle = this.bgColor;\n    this.ctx.fillRect( 0, 0, $t.pz.w, $t.pz.h );\n    for (var se,i=0,at=this.svgEls; i<at.length; i++){\n      se= at[i];\n      if (se.isVisible)  this.ctx.drawImage(se.img, se.pos.x, se.pos.y);\n      at[i].pos.x += at[i].vel.x;  //TODO: time\n      at[i].pos.y += at[i].vel.y;\n    }\n  }\n  this.addItem= function(el){  this.svgEls.push(el); }\n  this.getEventPos= function(evt) {\n        var rect = this.canvas.getBoundingClientRect();\n        return {  x: evt.clientX - rect.left, y: evt.clientY - rect.top };\n  }\n}\n//-----\nIconMaker= function(){\n  this.size= {width:50, height:50};\n  this.textColor= 'blue';\n  this.mkIconImg= function( s, color ){\n    var res, ctx, cnv= document.createElement('canvas');\n    for (var m in this.size) cnv[m] = this.size[m];\n    (ctx=cnv.getContext('2d')).fillStyle= color;\n    ctx.translate(this.size.width/2,this.size.height/2);\n    this.drawImg( ctx, s );\n    (res=new Image()).src= cnv.toDataURL(\"image/png\", 0.5);\n    return res;\n  }\n  this.drawImg= function(ctx, s){\n    ctx.arc(0,0,this.size.width/2,0,Math.PI*2,true);\n    ctx.fill();\n    var imd= ctx.getImageData( this.size.width/2,2,2,2 );\n    var inv=(imd.data[0]+imd.data[1]+imd.data[2] < 255)? \"white\" : \"blue\";\n    ctx.strokeStyle= inv;\n    ctx.arc(0,0,this.size.width/2,0,Math.PI*2,true);\n    ctx.stroke();\n\n    ctx.textAlign='center';\n    ctx.fillStyle= inv;\n    ctx.scale( 3*this.size.width/50, 3*this.size.height/50 );\n    ctx.fillText(s, 0, 4.5);\n  }\n}\n//-----\nSvgEl = function(){\n  this.vel= {x:0, y:0, angle:0};\n  this.init= function(img, x, y, angle){\n    this.pos= {x:x, y:y, angle:angle, w:img.width, h:img.height};\n    this.img= img;\n    this.isVisible = true;\n  }\n  this.changeDir= function( oVel, dir ){\n    if ((dir[0]==0) && (dir[1]==0)) return oVel;\n    var spd= Math.sqrt( (oVel.x*oVel.x + oVel.y*oVel.y) /\n      (dir[0]*dir[0]   + dir[1]*dir[1]) );\n    oVel.x= Math.ceil(spd * dir[0]);\n    oVel.y= Math.ceil(spd * dir[1]);\n  }\n  this.init( new Image(), 0, 0, 0 );\n}\n//-----\nSvgElOverlay= function(){\n  this.overlayImgs= {};\n  this.clients= [];\n  this.addOverlay= function( name, img, x, y ){\n    this.overlayImgs[name] = {img:img, x:x, y:y};\n  }\n  this.mkDot= function( color, size ){\n    var imr= new IconMaker();\n    imr.size= {width:size, height:size};\n    return imr.mkIconImg( '', color );\n  }\n  this.applyOverlay= function( svgEl, name ){\n    var res;\n    for (var i=0, at=this.clients; i<at.length; i++){\n      if (!at[i].obj.isVisible) at[i]= at.pop();\n      if (at[i].obj==svgEl) res=at[i];\n    }\n    if (!res) this.clients.push( res={obj:svgEl, origImg:svgEl.img} );\n    res.obj.img= this.mergeImg( res.origImg, this.overlayImgs[name] );\n  }\n  this.mergeImg= function( bsImg, overlay ){\n    if (!overlay) return bsImg;\n    var ctx, cnv = document.createElement('canvas');\n    cnv.width= bsImg.width; cnv.height= bsImg.height;\n    (ctx= cnv.getContext('2d')).drawImage( bsImg, 0, 0 );\n    ctx.drawImage( overlay.img, overlay.x, overlay.y );\n    (res=new Image()).src= cnv.toDataURL(\"image/png\", 0.5);\n    return res;\n  }\n}\n//-----\nZoner= function(){\n  this.zoneSize = 60;\n  this.buckets= {};\n  this.setZone= function(el){\n    for (var i=0,g=this.zoneSize; i<99; i++,g+=this.zoneSize)\n      if (el.pos.x<g) return this.setZone2(el,i);\n    this.setZone2(el, 99);\n  }\n  this.setZone2= function(el,m){\n    for (var i=0,g=this.zoneSize; i<99; i++,g+=this.zoneSize)\n      if (el.pos.y<g) return this.book(el, el.zone=\"_\"+m+\"_\"+i);\n    return this.book(el, el.zone=\"_\"+m+\"_99\");\n  }\n  this.book= function( el, zn ){\n    if (!this.buckets.hasOwnProperty(zn)) this.buckets[zn]=[];\n    this.buckets[zn].push(el);\n    el.zoner= this;\n  }\n  this.getFromOtherZones= function( zone ){\n    var res=[];\n    for (var m in this.buckets)\n      if (m != zone)  this.addTo( res, m );\n    return res;\n  }\n  this.getNearby= function( zone ){\n    var res=[], at= zone.split('_');\n    at[1]= parseInt(at[1]);   at[2]= parseInt(at[2]);\n    for (var cz,i=-1; i<2; i++)\n      for (var j=-1; j<2; j++)\n        this.addTo( res, \"_\"+(at[1]+i)+\"_\"+(at[2]+j) );\n    return res;\n  }\n  this.addTo= function( ar, cz ){\n    if (!this.buckets[cz]) return;\n    for (var i=0,at=this.buckets[cz]; i<at.length; i++) ar.push( at[i] );\n  }\n}\n\njs612=pkg={};\npkg.svgMotion= new SvgMotion();\npkg.iconMaker= new IconMaker();\npkg.svgEl= new SvgEl();\npkg.svgElOverlay= new SvgElOverlay();\npkg.zoner= new Zoner();\npkg.svgMotion.exposeClassNames( pkg );\n\nif (_n)_n();","t613":"//5-24-2016 jchoy v0.125 timestamp\n//-----\nSimpleTime= function(){\n  new AppTool().inherit( this, AppTool );\n  var $t= this;\n  this.counter= new Counter();\n  this.start= function(){\n    this.addEl('div').innerHTML= document.title = 'Simple Timestamp'\n    var div=this.addEl('div');\n    this.addEl('div',div).innerHTML= \"&nbsp;<p>\"+ new Date().toLocaleString();\n    this.addEl('div',div).innerHTML= \"<p>For adding timestamps\"\n      +\"<br />to pdfs using screen shots\";\n    div.style.width= \"50%\";\n    div.style.position= \"absolute\";\n    div.style.left= \"25%\";\n    div.style.top= \"10%\";\n\n    this.addEl('meta', document.getElementsByTagName('head')[0] );\n    this._.setAttribute( \"name\",\"viewport\" );\n    this._.setAttribute( \"content\",\"width=device-width, height=device-height, initial-scale=1.0\" );\n  }\n}\njs613=pkg={};\npkg.starter= new SimpleTime();\nnew AppTool().exposeClassNames( pkg );\n\nif (_n)_n();","t614":"pkg={\"text\":\"Electrician\\nhttp://www.sfha.org/RENT_INCREASE_REQUEST_FORM.pdf\\nsick pay\\nAndroid light sensor\\nAct mouthwash\\nR.w. project\\nhttp://lowellathletics.olinesports.com/links.php\\n///\\nShows to watch\\nBlacklist, NBC\\nHoudini and Doyle, Fox\\nElementary, CBS\\nBetter Call Saul, AMC\\nGraceland, USAN\\n\\n=======11.\\nCuqo 266\\nCuqi 194+106\\nCu00 57\\n\\nBuck 2219-498-175\\nBusv 254\\nprem 141-50\\nMC 1800\\nNC 1500\\nOC 2400\\n\\nAmex 136.42p8 /5\\nEdFin 236 p8 /5\\nBar3 186:9 /7\\nBar5 1000:9 /7\\nCiti 11809 177p8 /9\\n@He 498p7 /13\\n@Dis 14740 270p7 /19\\nCal 13.53p8 750:9 /20\\n\\n##Pay w/ cred\\nProg 176.83:8 /26\\nOrth 315:6 /20\\nDrim 0 /13\\n\\n0% until\\ndisc 8/2017\\nciti 1/2017\\n\\nhttp://#h/commit/\\nhttp://#h/ts\\nhttp://#h/twigbud.htm?js=619&cts=622,621\\nhttp://ide.c9.io/jcc9/lipaotwig\\n\\ndefcmd jscurl JsCurl\\ndefcmd foo Foo623\\nloadjs /ts/text/?i=623\\n*\"}\nif(_n)_n()","t615":"pkg={\"text\":\"Sat Ono Loa Grill\\nSun Lava Java, LL\\nMon Hilo, paradise, HI style\\nTue Grindz, Lemongrass\\nWed Grindz, Big Island grill\"}\nif(_n)_n()","t616":"//js616 from localImg.html v0.112\nSnApp= function(){\n  new AppTool().inherit( this, AppTool );\n  var $t= this;\n  this.tsNum= '603'\n  this.msg= new Date().toLocaleString();\n  this.start= function(){\n    this.tsNum= this.cgi('ts','603',location);\n    this.addEl('div').innerHTML= document.title = 'Local Image ';\n    this.form= this.setupForm( $t.addEl('div') );\n    this.div= this.addEl('div');\n    //this.loadJs(this.tsNum);\n  }\n  this.setupForm= function(fm){\n    var fm = $t.addEl( 'form', $t.div );\n    $t.addEl( 'input', fm ).type= 'file';\n    $t._.onchange= function(){$t.useFile(this.files)};\n    return fm;\n  }\n  this.useFile= function(files){\n    if (files.length==0) return this.div.innerHTML='no files';\n    var fr= new FileReader();\n    fr.onload= function(evt){ $t.showFile(evt) }\n    fr.readAsDataURL(files[0]);\n  }\n  this.showFile= function(evt){\n    //this.addEl('img',this.div).src= evt.target.result;\n    this.img= new Image();\n    this.img.src= evt.target.result;\n    if (!this.cnv) {\n      this.addEl('canvas',this.div).width=this.img.width;\n      (this.cnv=$t._).height=this.img.height;\n      this.cnv.addEventListener('mousedown',\n        function(evt){$t.cnvClick(evt)} );\n      this.cnv.getContext('2d').drawImage(this.img,0,0);\n    } else this.isSecondImg= true;\n  }\n  this.cnvClick= function(evt){\n    var pos= this.getEventPos(evt);\n    if (this.isSecondImg)\n      this.cnv.getContext('2d').drawImage(this.img,pos.x,pos.y);\n    else {\n      var ctx= this.cnv.getContext('2d');\n      ctx.font=\"30px Arial\";\n      ctx.strokeStyle=\"black\";\n      ctx.fillStyle=\"white\";\n      this.msg= prompt(\"Enter text\",this.msg);\n      ctx.fillText( this.msg, pos.x, pos.y )\n      ctx.strokeText( this.msg, pos.x, pos.y )\n    }\n  }\n  this.getEventPos= function(evt) {\n        var rect = this.cnv.getBoundingClientRect();\n        return {  x: evt.clientX - rect.left, y: evt.clientY - rect.top };\n  }\n  this.gotNewPkg= function(s){  //override\n  }\n}\n\njs616=pkg={};\npkg.starter= new SnApp();\npkg.starter.exposeClassNames( pkg );\n\n\npkg.starter.start();\n","t617":"//6-10-2016 jchoy v0.114 use SnCurly\nnew SnCurly().start( \"618\"\n      ,\"Foo618,DivHidMgr\"\n      ,function(){ new Foo618().start() }\n    );\n","t618":"//6-11-2016 jchoy ts618 v0.127\nfunction DivHidMgr(){\n  this.clients= [];\n  var $t= this;\n  this.addClient= function( div ){\n    this.clients.push(div);\n  }\n  this.showOneDiv= function(div){\n    for (var i=0,at=this.clients; i<at.length; i++)\n      at[i].style.display= 'none';\n    div.style.display= 'block';\n  }\n  this.mkFcn= function(dv){\n    return function(){ $t.showOneDiv(dv) }\n  }\n  this.mkFcns= function(){\n    var res=[];\n    for (var i=0,at=this.clients; i<at.length; i++)\n      if (at[i].parentNode==null) at[i]= at.pop();\n    for (var i=0,at=this.clients; i<at.length; i++)\n      res.push( this.mkFcn(at[i]) )\n    return res;\n  }\n}\nfunction Foo618(){\n  new AppTool().inherit( this, AppTool );\n  this.start= function(){\n    this.dhm= new DivHidMgr();\n    this.navTrak= new DivHidMgr();\n    for (var i=0; i<5; i++) this.addHidDiv(i);\n    for (var i=0,at=this.navTrak.clients; i<at.length; i++) this.mkNav( at[i] );\n    this.dhm.showOneDiv(this.dhm.clients[0]);\n  }\n  this.addHidDiv= function(s){\n    this.addEl('div').innerHTML= '<textarea rows=5 cols=36></textarea>';\n    this._.style.backgroundColor= '#EEEEDD';\n    this._.style.margin= '3 3 3 3';\n    this.dhm.addClient( this._ );\n\n    this.addEl('div', this._).innerHTML= 'nav';\n    this.navTrak.addClient( this._ );\n  }\n  this.mkNav= function(navDiv){\n    navDiv.innerHTML='';\n    for (var i=0,at=this.dhm.clients,af=this.dhm.mkFcns(); i<at.length; i++)\n      if (at[i] != navDiv.parentNode){\n        this.addEl('a',navDiv).innerHTML= '['+i+']';\n        this._.href= '#';\n        this._.onclick= af[i];\n        this.addEl('span',navDiv).innerHTML=' ';\n      } else {\n        this.addEl('b',navDiv).innerHTML= ' '+i+' ';\n      }\n  }\n}\n","t619":"//7-2-2016 jchoy v0.118 CurlyStarter, cgi\n//6-10-2016 jchoy v0.114 use SnCurly\n\nvar sc= new SnCurly();\nif (sc.cgi(\"bn\",\"\",location)==\"relic\"){\n  new SnCurly().start( \"620,621\"\n      ,\"Foo620,TestRig,RelicClient,RelicPServer,ConSpool\"\n      ,function(){ new Foo620().start() }\n    );\n} else sc.start( sc.cgi(\"cts\",\"620,621\",location)\n      , sc.cgi(\"ccn\",\"CurlyStarter,ConSpool\",location)\n      , function(){ new CurlyStarter().start() }\n    );\n","t620":"//7-2-2016 jchoy v1.147 ConSpool, TaApp, toLowerCase, CurlyStarter\n//6-26-2016 jchoy ts620 Foo620, TestRig, RelicClient, FlexPoll\n//TODO: checkEngine/ping, cfg, RelicCode, HiLoGame\n//-----\nfunction FlexPoll(){\n  this.ims = {cur:1000, max:15000, step:500}\n  this.getDelayMs= function(n){\n    if (this.ims.cur<this.ims.max) this.ims.cur += this.ims.step;\n    return (n) ? (this.ims.cur=n) : this.ims.cur;\n  }\n}\n//-----\nfunction TaApp(){\n  var $t= this;\n  var $d= document;\n  this.start= function(s, enterFcn){\n    if (enterFcn) this.enterFcn=enterFcn;\n    ta=$d.body.appendChild($d.createElement('div')).appendChild(\n      $d.createElement('textarea'));\n    ta.cols= 40;  ta.onkeypress= this.doTa;\n    if (s) ta.value=s;\n  }\n  this.doTa= function(ev){\n    for (var n=this.value.split('\\n').length; n<20; n=20) this.rows=n+2;\n    if (!$t.enterFcn) {\n    } else if (ev.keyCode != 13) {\n    } else if (this.selectionEnd==this.value.length)\n      this.value+= $t.enterFcn( this );\n  }\n  this.enterFcn= function(ta){\n    if (ta.value.split('\\n').pop().toLowerCase()=='exit') ta.parentNode.removeChild(ta);\n    return '\\n';\n  }\n}\n//-----\nfunction RelicPServer(){\n  new AppTool().inherit( this, AppTool );\n  var $t= this;\n  this.ims = new FlexPoll();\n  this.status= \"stopped\";\n  this.count= 0;\n  this.textPkgUrl= \"https://relic-ololi-jcc9.c9users.io/relic/{0}\";\n  this.start= function(fnCode){\n    if (this.status != \"stopped\") return \"cannot start, stop first\";\n    if (!fnCode) fnCode=\n      \"fn=(function(){\\n\"\n       +\"  var $o={x:function(s){\\n    var t=s.split('test=').reverse()[0];\\n\"\n       +\"    var r=this.z+'/'+t;this.z=t;return r\\n  },z:''};\\n\"\n       +\"  return function(s){return $o.x(s)}\\n\"\n       +\"})()\";\n    this.userFcn= eval(this.userFnCode=fnCode);\n    this.doWork(this.status= \"started\");\n    return this.status;\n  }\n  this.stop= function(){  return this.status = \"stopping\";  }\n  this.startStop= function(){\n    if (this.status==\"stopping\") console.log( \"stopped successfully\" );\n    if (this.status==\"stopping\") return this.status=\"stopped\";\n    if (this.status==\"stopped\") return this.status;\n  }\n  this.showLogs= function(){\n    console.log( 'count='+this.count );\n    if (console.conspool) console.conspool.view();\n    return '';\n  }\n  this.showUserFcn= function() { return this.userFnCode }\n  this.setUserFcn= function(s) { this.userFcn= eval(this.userFnCode=s); return 'ok'; }\n  this.doWork= function(){\n    if (0 == (this.count++ % 100)) console.log('do work x100');\n    if (this.startStop( )) return;\n    pkg= {starter:{start:function(){}},x:0};\n    this.loadJs( (this.workInfo={status:'work'}).status );\n  }\n  this.gotNewPkg= function(s1){\n    if (this.startStop()) return;\n    if (s1 == 'work') {\n      if (pkg.errCode == 0) {\n        ($t._=this.workInfo).token= pkg.token;\n        $t._.status='comp';\n        var res= '&result='+this.userFcn(pkg.text);\n        this.loadJs( 'comp?id='+$t._.token+res );\n      } else {   //no work to do\n        console.log( 'no work to do '+pkg.errCode );\n        setTimeout( function(){$t.doWork()}, this.ims.getDelayMs() );\n      }\n    } else {\n      //this.doWork( this.workInfo = null );\n      setTimeout( function(){$t.doWork()}, this.ims.getDelayMs(500) );\n      return console.log( s1 +' [ACK comp] '+ pkg.token );\n    }\n  }\n}\n//-----\nfunction RelicClient(){\n  new AppTool().inherit( this, AppTool );\n  var $t= this;\n  this.textPkgUrl= \"https://relic-ololi-jcc9.c9users.io/relic/{0}\";\n  this.expiryMs= 25000;\n  this.isDone= false;\n  this.webGet= function(qy, fcn, errFcn){\n    if (this.workInfo) return;  //reject\n    this.workInfo= {cbFcn:fcn, errFcn:errFcn};\n    pkg= {starter:{start:function(){}}};\n    this.loadJs( this.workInfo.tag = 'req?test='+qy );\n  }\n  this.gotNewPkg= function(s1){\n    if (s1!=this.workInfo.tag)\n      return console.log( s1+ ' mismatched tag '+this.workInfo.tag);\n    this.workInfo.token= pkg.token;\n    this.workInfo.expiry= new Date( new Date().valueOf()+this.expiryMs );\n    this.gotNewPkg= function(){};\n    this.checkResponse();\n  }\n  this.gotRespPkg= function(s1){\n    if (s1 != this.workInfo.tag)\n      return console.log( s1+ ' misMatched tag '+this.workInfo.tag);\n    if (0 == pkg.errCode) {\n      this.isDone= true;\n      console.log( 'workdone '+s1 );\n      this.workInfo.cbFcn(pkg);\n    } //else ignore\n  }\n  this.checkResponse= function(){\n    if (this.isDone) return;\n    this.loadJs( this.workInfo.tag='check?id=' +this.workInfo.token );\n    this.gotNewPkg= this.gotRespPkg;\n    if ($t.workInfo.expiry.valueOf() < new Date().valueOf())\n      return $t.cancelWork('timed out');\n    setTimeout( function(){$t.checkResponse()}, 2000 );\n  }\n  this.cancelWork= function( msg ){\n    this.gotNewPkg= function(){}\n    if (msg) this.workInfo.errFcn(msg);\n  }\n}\n//----- performs 2 step request using RelicClient\nfunction TestRig(){\n  new AppTool().inherit( this, AppTool );\n  var $t= this;\n  this.start= function(div){\n    div.innerHTML= '';\n    var fm = this.addEl('form',div);\n    this.addEl('input', fm).name= 'tx1';\n    this._.size=66;\n    this.addEl('input', fm).type= 'button';\n    this._.value= 'Go';\n    this._.onclick= this.doClick;\n    this.resDiv = this.addEl('div', fm);\n  }\n  this.doClick= function(){\n    var inVal = this.form.tx1.value;\n    if (inVal.indexOf('http')==0){\n      $t.resDiv.innerHTML = this.form.tx1.value;\n      $t.textPkgUrl= this.form.tx1.value;\n      $t.loadJs($t.tag=Math.random());\n    } else {\n      $t.resDiv.innerHTML = \"waiting...\";\n      new RelicClient().webGet( inVal, $t.gotRCResponse, $t.gotRCErr );\n    }\n  }\n  this.gotRCResponse= function(pkg){\n      $t.resDiv.innerHTML = pkg.text;\n  }\n  this.gotRCErr= function(msg){ $t.resDiv.innerHTML = msg; }\n}\n//-----\nfunction Foo620(){\n  new AppTool().inherit( this, AppTool );\n  new AppTool().inherit( this, TaApp );\n  var $t= this;\n  this.ver= 'v1.147';\n  this.rps= new RelicPServer();\n  this.start= function(){\n    new ConSpool().start();\n    this.addEl('textarea').cols= 40;\n    this._.onkeypress= this.doTa;\n    this.addEl('br');\n  }\n  this.enterFcn= function(ta){\n    var s=ta.value.split('\\n').pop().toLowerCase();\n    if (s=='add') return [new TestRig().start($t.addEl('div')),'\\ndone\\n'][1];\n    if (s=='ver') return '\\n'+this.ver+'\\n';\n    if (s=='sstart') return '\\n'+$t.rps.start()+'\\n';\n    if (s=='sstop') return '\\n'+$t.rps.stop()+'\\n';\n    if (s=='console.view') return '\\n'+$t.rps.showLogs()+'\\n';\n    if (s=='showfcn') return '\\n'+$t.rps.showUserFcn()+'\\n';\n    if (s=='//setfcn') return '\\n'+$t.rps.setUserFcn(sa)+'\\n';\n    return '\\nError - Valid Commands: add, ver, sstart, sstop, console.view, showfcn, //setfcn \\n';\n  }\n}\nCurlyStarter= Foo620;","t621":"//7-27-2016 jchoy v1.128 Counter, quickDate(fix2), elapsedFmt/neg nums, TimeoutMark\n//6-30-2016 jchoy v1.115 ConSpool\n//-----\nfunction ConSpool(){\n  this.spool= [];  this.state= {isActive:true};\n  this.cfg= {max:1000,sep:'\\n'};\n  var $d= document;\n  this.start= function(){\n    if (this.oldcon==console) return;\n    this.oldcon= console;\n    console= {log:function(s){this.conspool.log(s)},conspool:this};\n    console.log( 'conspool started' );\n  }\n  this.TaApp= function(){\n    this.start= function(s){\n      var ta=$d.body.appendChild($d.createElement('div')).appendChild(\n        $d.createElement('textarea') );\n      ta.value=s; ta.rows=10; ta.cols=50;\n    }\n  }\n  this.log= function(s){\n    this.spool.push([new Date().toLocaleString(), s]);\n    if (this.spool.length>this.cfg.max) this.spool.shift();\n    this.oldcon.log(s);\n  }\n  this.view= function(){\n    var res='';\n    for (var i=0,at=this.spool; i<at.length; i++) res+= at[i].join(' ')+this.cfg.sep;\n    try { new TaApp().start(res) } catch(e) { new this.TaApp().start(res); }\n  }\n  this.clear= function(){this.spool.length=0}\n  this.pause= function(v){this.state.isActive=(!v)?false:true}\n}\n//-----\nCounter= function(){\n    this.add= function(key){  if (!this.data[key]) this.data[key]=0;   this.data[key]++;  }\n    this.restart= function(){  this.data= {};  this.startTime = new Date(); }\n    this.count= function(key){  return (this.data[key])? this.data[key] : 0;  }\n    this.elapsedTimeSeconds= function(){ return this.elapsedTimeMs()/1000 }\n    this.elapsedTimeMs= function(){  return new Date().valueOf()-this.startTime.valueOf(); }\n    this.restart();\n}\nCounter.quickDate=function(s){ //converts shorthands with just time or date to valid1\n    var res= new Date(new Date().toLocaleDateString()+','+s);\n    if (!isNaN(res.valueOf())) return res.toLocaleString();\n    if (!isNaN(new Date(s+',6:00:00').valueOf())) return s+',6:00:00';\n    return s;\n}\nCounter.elapsedFmt= function(ms){\n    if (ms < 0) return \"0:00:00\";\n    return Math.floor(ms/3600/24000)+' day(s)'+new Date(ms).toUTCString().split(' 197')[1].substr(1,9);\n}\n//----\nTimeoutMark= function(){\n  var $t= this;\n  this.start = function( sec, $tag ){\n    this.isDone = false;\n    console.log( 'TimeoutMark '+$tag );\n    setTimeout( function(){\n      if (!$t.isDone) console.log('timed out: '+$tag)\n      $t.isDone=true;\n    }, sec*1000 );\n    return this;\n  }\n  this.checkIsDone= function(){ return (this.isDone) || !(this.isDone=true); }\n}\n","t622":"//8-11-2016 jchoy - predef loadjsc, removed conspool, LoadJs using SnLiteLoader\n//7-2-2016 jchoy TaApp, CurlyStarter\npkg= pkg622={ver:'CETB 1.358'}\n//----\npkg.GrabBagLoop=function(){\n  new AppTool().inherit( this, GrabBag );\n  this.isLoop= true;\n}\npkg.GrabBagStop=function(){\n  this.start= function(at){\n\tif (at.length>1) new GrabBag().item('ev_stop_'+at[1])(); return 'ok' }\n}\npkg.GrabBag=function(){\n  if (typeof(w_grabBag)==='undefined') w_grabBag={};\n  var $t=this;\n  this.item= function(k,v){if (v){w_grabBag[k]=v}; return w_grabBag[k]}\n  this.start= function(at){\n\tif ((at.length>2) && (at[2].charAt(0)=='<')) return this.pipeFile(at[1],at[2]);\n\treturn ['ok',this.item(at[1], at.slice(2).join(' '))][0];\n  }\n  this.pipeFile=function( k, fn ){\n\tif (!new Sto().isOk) return 'No Storage';\n\tif (this.isLoop) this.item( 'ev_stop_'+k, function(){$t.isLoop=false} );\n\tvar at= localStorage.getItem( fn.substr(1) ).split('\\n');\n\treturn [this.pfLine(k,at), 'ok '][1];\n  }\n  this.pfLine=function( k, at ){\n\tif (this.isLoop) at.push(at[0]);\n\tthis.item(k, at.shift());\n\tif (at.length>0) setTimeout( function(){ $t.pfLine(k,at) }, 2000 );\n  }\n}\npkg.LinkMaker= function(){\n  new AppTool().inherit( this, AppTool );\n  this.start= function(at){\n    if (at[1] != '.') {\n      this.addEl('a', this.addEl('div')).href= at[1];\n      this._.innerHTML= at[1];\n    } else this.addEl('span').innerHTML= at.slice(2,99).join(' ');\n    var rs= this._.innerHTML.replace(/\\$date/i,new Date().toLocaleString());\n    return ['ok',this._.innerHTML=rs,this.wrapCloser( this._ )][0];\n  }\n  this.wrapCloser= function(el, isBr){\n    this.addEl('span',this.addEl('div')).innerHTML='[x] '; //[.][o]\n    this._.onclick= function(){ new DomAni().delEl(this.parentNode) }\n    if (isBr) this.addEl('br',this._.parentNode);\n    this._.parentNode.appendChild(el);\n  }\n}\npkg.DomAni= function(){\n  this.delEl=function(el){ el.parentNode.removeChild(el) }\n}\n//----\npkg.StoEdit= function(){\n  this.start= function(at){\n    var st=new Sto();\n    if (!st.isOk) return 'error';\n    return ['ok', new TaAutoSave().init(at[1]).start( st.lo.getItem(at[1]), null )][0];\n  }\n}\n//----\npkg.EvalJs= function(){\n  new AppTool().inherit( this, AppTool );\n  this.sc= \"MyClass=function(){\\n  this.start=function(at){\\n  }\\n}\";\n  this.start= function(at){\n    var $st= new Sto();\n    if (at.length>1) this.sc= at[1]+'='+window[at[1]];\n    else if ($st.isOk) this.sc= $st.lo.getItem( \"evaljs_data\" ) || this.sc;\n    new TaApp().start( this.sc, function(ta){\n      if ($st.isOk) $st.lo.setItem( \"evaljs_data\", ta.value );\n      if (ta.value.split('\\n').pop().toLowerCase() != '//evaljs') return '\\nusage: //evaljs';\n      try { eval( ta.value ); } catch (e) { return '\\nError '+e.message; }\n      return '-ok';\n    });\n    return 'ok';\n  }\n}\n//----\npkg.TaApp= function(){\n  var $t= this;\n  var $d= document;\n  this.start= function(s, enterFcn){\n    if (enterFcn) this.enterFcn=enterFcn;\n    var ta=$d.body.appendChild($d.createElement('div')).appendChild(\n      $d.createElement('textarea'));\n    ta.cols= 40;  ta.onkeypress= this.doTa;\n    ta.onfocus= function(){if (this.rows==2)this.rows=8}\n    new LinkMaker().wrapCloser(ta,1);\n    if (s) ta.value=s;\n  }\n  this.doTa= function(ev){\n    for (var n=this.value.split('\\n').length; n<20; n=20) this.rows=n+2;\n    if (!$t.enterFcn) {\n    } else if (ev.keyCode != 13) {\n    } else if (this.selectionEnd==this.value.length)\n      this.value+= $t.enterFcn( this );\n  }\n  this.enterFcn= function(ta){  return '\\n'; }\n}\npkg.TaAutoSave= function(){\n  new AppTool().inherit( this, TaApp );\n  var $t= this, $st=new Sto();\n  this.counter= new Counter();\n  this.init= function( storeName ){\n    if ($st.isOk) this.storeName= storeName; return this; }\n  this.doTa= function(ev){\n    var ta= this, x=$t.counter.restart();\n    if ($st.isOk) setTimeout( function(){ $t.saveTa3(ta) }, 3000 );\n  }\n  this.saveTa3= function(ta){\n    if ((this.counter.elapsedTimeMs() < 3000) || (!this.storeName)) return;\n    if (document.contains(ta)) return $st.lo.setItem( this.storeName, ta.value );\n  }\n}\n//----\npkg.Sto= Sto= function(){\n  this.isOk= (typeof(Storage) !== \"undefined\"); \n  this.lo= (this.isOk)? localStorage : null;\n}\npkg.StoLog= function(fn){\n  var $t=this;\n  this.cfg= {st:new Sto(), nm:((fn)?fn:'sto.log'), tsPipe:['']};\n  this.chkPipe= function(s){\n    this.cfg.tsPipe.push(s); return (this.cfg.tsPipe.shift()==s)? '':s;\n  }\n  this.log= function(s){\n    var ts= $t.chkPipe(new Date().toLocaleString());\n    var pl, fn=$t.cfg.nm, lo=$t.cfg.st.lo;\n    if ((pl=lo.getItem(fn)) && (ts)) pl= pl.substr(-15999)+'\\n'+ts;\n    return [lo.setItem(fn, pl+'\\n'+s), s][1];\n  }\n  if (!this.cfg.st.isOk) this.log= function(s){ return s }\n}\npkg.CmdAutostart= function(){\n  var $t=this;\n  this.start= function(ce){\n    this.cfg= {sl:new StoLog('autostart.log'), nc:'startup'};\n    var st= this.cfg.sl.cfg.st, nc=this.cfg.nc, pl;\n    if (!st.isOk) return;\n    if (pl= st.lo.getItem(nc)) this.parse(ce, pl);\n  }\n  this.parse= function(ce,sf){\n    for (var i=0,at=sf.split('\\n'); i<at.length; i++)\n      if (!this.doSleep(ce, at[i], at, i)) { return;\n      } else ce.parse( this.cfg.sl.log(at[i]) );\n  }\n  this.doSleep= function(ce, it, at, i){\n    if (!it.match(/^sleep/i)) return true;\n    var sf= at.slice(i+1).join('\\n'), ms=parseInt(it.substr(5))*1000;\n    setTimeout( function(){ $t.parse( ce, sf ); }, ms );\n  }\n}\n//----\npkg.CmdEngine= function(){\n  var $t= $ce= this;\n  this.assets= {};\n  this.addCmd= function(s, fcn){ this.assets[s]=fcn };\n  this.addCmd( 'link', function(at){ return new LinkMaker().start(at); } );\n  this.addCmd( 'edit', function(at){ return new StoEdit().start(at); } );\n  this.addCmd( 'evaljs', function(at){ return new EvalJs().start(at); } );\n  this.addCmd( 'loadjsc', function(at){ return new LoadJsc().start(at); } );\n  this.addCmd( 'loadjs', function(at){ return new LoadJs().start(at); } );\n  this.parse= function(taval){\n    var args= taval.split('\\n').pop().split(' '), res=this._='';\n    var fn= (args[0].charAt(0)=='#')? function(){return 'ignored'} : this.assets[args[0]];\n    if (!fn) fn= this.assets[args[0].toLowerCase()];\n    if (fn) this._= this.crWrap( fn(args) );\n    return (fn)? true : false;\n  }\n  this.crWrap= function(s){ return '\\n'+s+'\\n'; }\n  this.init= function(){\n    this.assets['defcmd']= function(at){\n      if (at.length < 3) return 'syntax: defcmd name class';\n      var $cn= at[2];\n      $ce.assets[at[1]]= function(at){ return new window[$cn]().start(at) }\n      return 'ok';\n    }\n    this.addCmd( 'help', function(at){ \n      var s=''; for (var m in $ce.assets) s+=' '+m;\n      return 'available commands:'+s;\n    } );\n    return this;\n  }\n}\n//-----\npkg.PkgTool=function(){\n  this.start= function(pkg, at){\n    for (var m in pkg) if (m.match(/^[A-Z]/))\n      window[m]=pkg[m];\n    if (at) for (var i=0,st=new Sto(); (i<at.length) && (st.isOk); i++)\n      st.lo.setItem( at[i].name, at[i].text );\n    if (at) this.ceParse( at[0] );\n  }\n  this.ceParse= function(ci){\n    if (ci.name != 'pkg.startup') return;\n    for (var i=0,sl=new StoLog('pt.log'), at=ci.text.split('\\n');i<at.length;)\n      $ce.parse( sl.log(at[i++]) );\n  }\n}\npkg.LoadJsc=function(){\n  this.start=function(at){\n    var $fn=function(){ new (window['CeStarter'+at[1]])().start(pkg); };\n    return ['Ok',new SnCurly().start( at[1], at[2], $fn )][0];\n  }\n}\npkg.LoadJs= function(){\n  this.start=function(at){ return ['Ok',new SnLiteLoader().loadJs( at[1] )][0] }\n}\n//----\npkg.CurlyStarter= function(){\n  new AppTool().inherit( this, AppTool );\n  new AppTool().inherit( this, TaApp );\n  var $t= this;\n  this.ver= pkg622.ver;\n  this.cmdEngine= new CmdEngine().init();\n  this.start= function(){\n    this.sl= new StoLog('err.log');\n    window.onerror= function(e,u,l){ $t.sl.log(e) }\n    document.title= 'CETB'\n    this.addEl('textarea').cols= 40;\n    this._.onkeypress= this.doTa;\n    this.addEl('br');\n    setTimeout( function(){ new CmdAutostart().start($ce) }, 400 );\n  }\n  this.enterFcn= function(ta){\n    var s=ta.value.split('\\n').pop().toLowerCase();\n    if (s=='ver') return '\\n'+this.ver+'\\n';\n    if (this.cmdEngine.parse(ta.value)) return this.cmdEngine._;\n    return '\\nError - Valid Commands: ver, help \\n';\n  }\n}\nnew pkg.PkgTool().start(pkg);","t623":"//7-25-2016 jchoy \npkg= pkg623= { ver:'0.757' };  //sms_del, VfsStoLayer, networkRecovery, AutoReload\n//7-6-2016 jchoy v0.215 ping, jscurl, LinkMaker, Send-Sched-SMS, \n//TODO: cfg, RelicCode, HiloGame, wiggle, autoreload prompt\n\n//-----\npkg.SendSMS=SendSMS=function (){\n  new AppTool().inherit( this, AppTool );\n  this.start=function(at){\n    var ifrm= this.addEl('iframe');\n    this.ifr = ifrm.contentWindow || ifrm.contentDocument.document || ifrm.contentDocument;\n    var fm, d2= this.owc( this.ifr.document, '' );\n    this.addEl( 'form', d2.body ).action='http://textbelt.com/text';\n    this.addEl( 'input', fm=this._ ).name='number';\n    this.addEl( 'input', fm ).name='message';\n    if (at.length>2) this.submitForm( at, fm );\n    setTimeout( function(){ ifrm.parentNode.removeChild(ifrm) }, 31000 );\n    return ['ok', console.log( 'sendSMS '+at )][0];\n  }\n  this.submitForm= function(at, fm){\n    fm.number.value= at[1];\n    fm.message.value= at[2];\n    for (var i=3; i<at.length; i++) fm.message.value+= ' '+at[i];\n    fm.method= 'POST';\n    setTimeout( function(){ fm.submit() }, 6000 );\n  }\n  this.owc= function( obj, s ){ obj.open(); obj.write(s); obj.close(); return obj; }\n}\n\n//-----\npkg.Sdb= Sdb=function(){\n  this.getRow= function(nm, col0, count){\n    var res= [], tbl= this.getTable(nm);\n    if (col0) return tbl[col0];\n    for (var m in tbl) res.push(tbl[m]);\n    res.sort( function(a,b){ return a[0]>b[0] } );\n    if (count<0) return res.splice(count);\n    return res.slice(0, count);\n  }\n  this.deleteRow= function(nm, col0){\n    var tbl= this.getTable(nm);\n    delete tbl[col0];\n    this.getAssets().writeFile( nm, JSON.stringify(tbl) );\n  }\n  this.getAssets= function(){\n    if (!this['assets']) this.assets= new Vfs();\n    return this.assets;\n  }\n  this.getTable= function(nm){\n    var s= this.getAssets().readFile(nm);\n    if (!s) return {};\n    return JSON.parse(s);\n  }\n  this.appendRow= function(nm, atr){\n    var tbl= this.getTable(nm);\n    tbl[atr[0]]=atr;\n    this.getAssets().writeFile( nm, JSON.stringify(tbl) );\n  }\n}\npkg.DumpDb= DumpDb=function(){\n  this.start=function(at){\n    return ['ok',new TaApp().start( sdb.getRow( at[1], null, at[2] ).join('\\n') )][0];\n  }\n}\npkg.Vfs= Vfs=function(){\n  this.assets= {};\n  this.vsl= new VfsStoLayer();\n  this.getFileNames=function(){\n    var m=[];\n    for (var m in this.assets) res.push(m);\n    return res;\n  }\n  this.readFile= function(fn){\n    this.assets[fn] = this.vsl.getFile( fn, this.assets[fn] );\n    if (!this.assets[fn]) return '';\n    return this.assets[fn].text;\n  }\n  this.writeFile= function(fn, s){\n    this.assets[fn]= {text:s, modDate:new Date()}\n    this.vsl.dirtyFile( fn, s );\n  }\n}\npkg.VfsStoLayer= VfsStoLayer= function(){\n  this.counters= {};\n  this.cfg= {delayMs: 5000, pref:'vfg_', isStore: (typeof(Storage) !== 'undefined')};\n  var $t= this;\n  this.getFile= function( nm, payload ){\n    if (payload) return payload;\n    var res= ($t.cfg.isStore)? localStorage.getItem($t.cfg.pref+nm) : null;\n    return (res)? {text:res, modDate:new Date()} : null;\n  }\n  this.dirtyFile= function( nm, payload ){\n    if (!this.cfg.isStore) return;\n    var counter = this.counters[nm] || new Counter();\n    (this.counters[nm]=counter).restart();\n    setTimeout( function (){$t.saveFile(nm,payload)}, $t.cfg.delayMs );\n  }\n  this.saveFile= function(nm,payload){\n    if (this.counters[nm].elapsedTimeMs()<$t.cfg.delayMs) return;\n    localStorage.setItem( $t.cfg.pref+nm, payload );\n  }\n}\n//-----\npkg.SchedSms= SchedSms= function(){\n  new AppTool().inherit( this, AppTool );\n  this.start= function(at, isSuppressDisplay ){\n    if (!window['sdb']) sdb= new Sdb();\n    sdb.appendRow( 'sms', [ new Date(at[1]).valueOf(), at[2], at[3] ] );\n    console.log( 'SchedSms '+at.join(' ') );\n    if (!isSuppressDisplay) new OurStatus().start( ['','sdb','status'] );\n    return ['ok (v0.139)', this.setupSdbPoll()][0];\n  }\n  this.setupSdbPoll= function(){\n    sdb.doPoll= function(){\n      var rows= sdb.getRow( 'sms', null, 10 );\n      if (rows.length>0){\n        var row= rows[0];\n        var rem= row[0]-new Date().valueOf();\n        if (rem<0) {\n          new SendSMS().start(row);\n          sdb.appendRow( 'sms_del', row.slice(0,2) );\n          sdb.deleteRow( 'sms', row[0] );\n        }\n        sdb.status= ['sms sched',row[2],Counter.elapsedFmt(rem),'to go'].join(' ');\n      }\n      setTimeout( sdb.doPoll, 11000 );\n    }\n    if (!sdb.isPolling) sdb.doPoll();\n      sdb.isPolling= true;\n  }\n}\npkg.SendSchedSms= SendSchedSms=function (){\n  new AppTool().inherit( this, AppTool );\n  this.tsNum= '624';\n  this.start=function(at){\n    var msg='';\n    for (var i=3; i<at.length; i++) msg+= at[i]+' ';\n    console.log( 'SendSchedSms '+msg+' '+at[2]+' '+at[1] );\n    this.sendPkg( {text:msg, number:at[2], time:Counter.quickDate(at[1])}, this.tsNum );\n    return 'ok';\n  }\n}\npkg.ListenTs= ListenTs=function (){\n  new AppTool().inherit( this, AppTool );\n  this.intvMs= 60000; //5 min\n  this.ver= pkg623.ver;\n  var $t= this;\n  this.nicks= {jhydro:'6283009814', jnokia:'4153180333', jtrac:'4156298175'};\n  this.hist= new Array();  this.counter= new Counter();\n  this.start= function(at){\n    if (at.slice(-1)==\"/ver\") return \"ok -v\"+this.ver\n    this.setNodeName(at);\n    new SchedSms().start( ['', new Date().getFullYear()+9+',0:00', '1', '_delete_me_'] );\n    this.log( 'start ListenTS at '+new Date().toLocaleString() );\n\n    w_lts= {status:'starting...'};\n    new OurStatus().start(['','w_lts','status']);\n    new AutoReload().networkRecovery( this.counter, 2*this.intvMs, \n      function(){ $t.loadJs($t.tsNum)} );\n    return ['ok -v'+this.ver, this.loadJs(this.tsNum)][0];\n  }\n  this.log= function(s){ sdb.appendRow( 'lts_log', [ new Date().valueOf(), s] ); console.log( s ); }\n  this.setNodeName= function(at){\n    if (isNaN(this.tsNum= at[1])) this.tsNum= '624';\n    var isStore = (typeof(Storage) !== 'undefined');\n    this.nodeName= (isStore)? localStorage.getItem('lts_node') : 'default';\n    if (at.length>2) this.nodeName=at[2];\n    if (isStore) localStorage.setItem('lts_node',this.nodeName);\n  }\n  this.gotNewPkg= function(){\n    var nq=0, s=JSON.stringify(pkg), x=this.counter.restart();\n    if (typeof(sdb) !== 'undefined') nq=sdb.getRow('sms',null,999).length;\n    w_lts.status='no change - '+new Date().toLocaleString()+' '+nq+' items';\n    setTimeout( function(){ $t.loadJs($t.tsNum) }, this.intvMs );\n\n    while (this.hist.length<2) this.hist.push(s);\n    if (this.hist.shift()==s) return;\n    w_lts.status= 'new sched item '+pkg.text;\n    var num= (this.nicks[pkg.number])? this.nicks[pkg.number] : pkg.number;\n    new SchedSms().start( ['', pkg.time, num, pkg.text], 1 );\n\n    var msg= sdb.getRow('sms_del',null,999).length +' sent';\n    this.sendPkg( {text:(nq+1)+' in queue, '+msg, nodeName:this.nodeName}, '626' );\n  }\n}","t624":"pkg={\"text\":\"wake up for cruise \",\"number\":\"jtrac\",\"time\":\"7/30/2016,4:30\"}\nif(_n)_n()","t625":"//7-27-2016 jchoy v0.151 TracMemFile, LStoEcho, AutoReload\n//7-19-2016 jchoy v0.121 BatteryStatus\n//----\nAutoReload= function(){\n  var $t = this;\n  this.start= function(at){\n    isOnline_AutoReload= true;\n    setTimeout( function(){ $t.reloadActuate(at) }, parseInt(at[1]) * 60*1000 );\n    return ['ok', console.log( 'AutoReload in ' +at[1]+ ' minutes.' )][0];\n  }\n  this.reloadActuate= function(at){\n    if (isOnline_AutoReload) { location.reload() } else new AutoReload().start(at);\n  }\n  this.networkRecovery= function(counter, intvMs, fcn){\n    console.log('networkRecovery in '+ (intvMs) );\n    if (counter.elapsedTimeMs() > intvMs) {\n      isOnline_AutoReload= false;\n      fcn();\n      console.log( 'networkRecovery activated'+new Date().toLocaleString() );\n    }\n    counter.restart();\n    setTimeout( function(){ $t.networkRecovery(counter, intvMs, fcn) }, intvMs );\n  }\n}\n//----\nBatteryStatus=function(){\n  new AppTool().inherit( this, AppTool );\n  var $t=this;\n  this.start=function(at){\n    if (\"getBattery\" in navigator) navigator.getBattery().then(\n      function(bat){ $t.showBattery(bat);\n        bat.addEventListener('chargingchange',$t.cbcc);\n        bat.addEventListener('levelchange',$t.cbcc);\n      } );\n    return 'ok - '+this.status;\n  }\n  this.cbcc= function(info){ $t.showChgStatus(info.target) }\n  this.showBattery= function(bat){\n    console.log('showBattery');\n    var panel= this.addEl('div');\n    this.addEl('span',panel).innerHTML='[x] ';\n    this._.onclick= function(){var p=this.parentNode;p.parentNode.removeChild(p)}\n    this.span=this.addEl('span',panel);\n    this.showChgStatus(bat);\n  }\n  this.showChgStatus= function(bat){\n    if (!document.contains(this.span)) {\n      bat.removeEventListener( 'chargingchange', this.cbcc );\n      bat.removeEventListener( 'levelchange', this.cbcc );\n    }\n    this.span.innerHTML= bat.level+' charging: '+bat.charging;\n  }\n}\n\n//----\n//Relies on js/vb script to populate an external file.\nTracMemFile=function(){\n  new AppTool().inherit( this, AppTool );\n  var $t= this;\n  this.hist=[''];\n  this.start=function(at){\n    this.addEl('input').type='file';\n    if (typeof(w_tracmemfile)==='undefined') w_tracmemfile={};\n    new OurStatus().start(['','w_tracmemfile','status_']);\n    this._.onchange= function(evt){ $t.useFile(evt) }\n    return ['ok', new LinkMaker().wrapCloser( this._ )][0];\n  }\n  this.useFileContents= function(evt){\n    this.hist.push(evt.target.result);\n    if (this.hist.shift() != evt.target.result) \n      w_tracmemfile.status_ = evt.target.result.match(/[0-9]+/);\n  }\n  this.useFile= function(evt){\n    this.f = evt.target.files[0]; \n    if (this.f) return this.readFile();\n    alert(\"Failed to load file\");\n  }\n  this.readFile= function(){\n    console.log('readFile');\n    var r = new FileReader();\n    r.onload = function(e) { $t.useFileContents(e) }\n    r.readAsText(this.f);\n    setTimeout( function(){$t.readFile()}, 20000 );\n  }\n}\n//----\nLStoEcho=function (){\n  this.start=function(at){\n    var atz= at.pop();\n    if (atz.indexOf('>>')==0){\n      var res= localStorage.getItem(atz.substr(2))+'\\n';\n      localStorage.setItem(atz.substr(2), res+at.splice(1).join(' '));\n    } else if (atz.indexOf('>')==0){\n      localStorage.setItem(atz.substr(1), at.splice(1).join(' '));\n    } else return at.join(' ')+' '+atz;\n    return 'ok';\n  }\n}\nLStoDel=function (){\n  this.start=function(at){  localStorage.removeItem(at[1]); return 'ok'; }\n}\nLStoBatch=function (){\n  this.start=function(at){\n    var res= localStorage.getItem(at[1]);\n    for (var i=0,at=res.split('\\n'); i<at.length; i++) $ce.parse( at[i] );\n    return res;\n  }\n}\n","t626":"pkg={\"text\":\"2 in queue, 12 sent\",\"nodeName\":\"vinton-acer\"}\nif(_n)_n()","t9900":"//8-5-2016 jchoy \n//PkgTool.ceParse\npkg= pkg9900= { ver:'0.132' };\n\n//-----\npkg.PkgTool= function(){\n  this.start= function(pkg, at){\n    for (var m in pkg) if (m.match(/^[A-Z]/))\n      window[m]=pkg[m];\n    if (at) for (var i=0; i<at.length; i++)\n      localStorage.setItem( at[i].name, at[i].text );\n    if (at) this.ceParse(at[0]);\n  }\n  this.ceParse= function(ci){\n    if (ci.name != 'pkg.startup') return;\n    for (var i=0,at=ci.text.split('\\n');i<at.length;)\n      $ce.parse(at[i++])\n  }\n}\npkg.LoadJsc= function(){\n  //ce usage: loadjs num className\n  this.start=function(at){\n      var $pn= 'CeStarter'+at[1];\n      new SnCurly().start(\n       at[1], at[2], function(){\n         var cls= window[$pn];\n         new (cls)().start(pkg); });\n      return 'Ok';\n  }\n}\n\nnew pkg.PkgTool().start(pkg);\n","t9901":"//8-9-2016 jchoy Pulse\npkg= pkg9901= { ver:'0.131' };\n\n//-----\npkg.StoDir=function(){\n  //new AppTool().inherit( this, AppTool );\n  this.start=function(at){\n    var s=\"\";\n    for (var m in localStorage) s+=m+' ';\n    return s;\n  }\n}\npkg.Pulse=function(){\n  new AppTool().inherit( this, AppTool );\n  var $t= this;\n  this.start= function(at){\n    this.tsNum = (at.length>1)? at[1] : 'default';\n    if (typeof(w_pulse) === 'undefined') w_pulse= {};\n    new OurStatus().start(['','w_pulse','status_'+this.tsNum]);\n    return ['ok (v1.258)', this.sendPing()][0];\n  }\n  this.sendPing= function(){\n    w_pulse['status_'+this.tsNum] = this.hiliteText('OFFLINE','red');\n    this.loadJs( this.tsNum );\n    setTimeout( function(){ $t.sendPing() }, 60*1000 );\n  }\n  this.hiliteText= function(s,bgclr){ return '<span style=\"background-color:'+bgclr+'\">'+s+'</span>' }\n  this.gotNewPkg= function(){ w_pulse['status_'+this.tsNum] =this.hiliteText('connected','lime'); }\n}\n\npkg.contents=[\n { name:\"pkg.startup\"\n   ,text:\"defcmd dir StoDir\\ndefcmd pulse Pulse\"\n }\n,{ name:\"pkg9901notes\"\n   ,text:\"v0.131\\n8/9/2016\"\n }\n]\npkg.CeStarter9901=function(){\n  var $p=pkg9901;\n  this.start=function(){\n    new PkgTool().start($p, $p.contents);\n  }\n}\nnew PkgTool().start(pkg);\n","t9902":"//8-10-2016 jchoy\npkg=pkg9902= {ver:'v0.214'} //OutStatus, DomAni.pinchDel\n\npkg.OurStatus=function (){\n  new AppTool().inherit( this, AppTool );\n  var $t= this;\n  this.hist=[''];\n  this.start= function(at){\n    this.gName= at[1]; this.pName= at[2];\n    var outerDiv= this.addEl( 'div' );\n    this.addEl('span', outerDiv).innerHTML= '[x] ';\n    this._.onclick= function(){ outerDiv.parentNode.removeChild(outerDiv) }\n    this.span = this.addEl('span', outerDiv);\n    return ['ok',this.update()][0];\n  }\n  this.update= function(){\n    if (!document.contains(this.span)) return;\n    this.hist.unshift( window[this.gName][this.pName] );\n    if (this.hist.pop() != this.hist[0]) new DomAni().odoChange(this.span, this.hist[0]);\n    setTimeout( function(){$t.update()}, 2000 ); \n  }\n}\n//----\npkg.DomAni= function(){\n  var $raf=requestAnimationFrame;\n  this.odoChange= function( el, s ){\n    var n=0, z=el.offsetHeight, es=el.style, x= el.parentNode.style.overflow= 'hidden';\n    (function fa(){ es.top=n--; $raf((n>-z)?fa:fm);})(es.position='relative')\n    function fm(){ el.innerHTML=s; fb() }\n    function fb(){ es.top=n++; $raf((n<0)?fb:fz) }\n    function fz(){ es.position='static' }\n  }\n  this.pinchDel= function( el ){\n    var $ph= el.parentNode.insertBefore(document.createElement('div'),el);\n    var dz, z=el.offsetHeight, es=$ph.style, x= $ph.style.overflow= 'hidden';\n    $ph.appendChild(el); dz= (z>20)?5:2; \n    (function fa(){ es.height=z-=dz; $raf((z>1)?fa:fz);})(el.position='relative')\n    function fz(){ $ph.parentNode.removeChild($ph) }\n  }\n  this.fadeDel= function( el ){\n    this.fadeOut( el, function(){ el.parentNode.removeChild(el) }, el.style.opacity=0.8 ) }\n  this.fadeChange= function( el, s ){\n    this.fadeOut(el, function(){ el.innerHTML=s; $t.fadeIn(el) }, el.style.opacity=1 ); }\n  this.fadeIn= function( el, fnz ){\n    (function fr(){ el.style.opacity-= -.01; $raf((el.style.opacity<1)?fr:fnz) })(); }\n  this.fadeOut= function( el, fnz ){\n    (function fr(){ el.style.opacity-= .01; $raf((el.style.opacity>0)?fr:fnz);})() }\n  this.delEl= function(el){ this.pinchDel(el) }\n}\npkg.contents=[\n { name:\"pkg.startup\"\n   ,text:\"defcmd statbox OurStatus\"\n }\n,{ name:\"pkg9902notes\"\n   ,text:\"v0.214\\n8/10/2016\\nDomAni.pinchDel, delEl\"\n }\n]\npkg.CeStarter9902=function(){\n  var $p=pkg9902, $su=pkg9902.contents[0];\n  this.start=function(){\n    new PkgTool().start($p, $p.contents);\n    $ce.parse( $su.text );\n  }\n}\nnew PkgTool().start(pkg);"}